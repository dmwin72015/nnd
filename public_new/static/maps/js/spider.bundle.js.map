{"version":3,"sources":["webpack:///./appSrc/less/spider.less","webpack:///./appSrc/lib/dm-modals.js","webpack:///./appSrc/login/spider.js"],"names":[],"mappings":";;;;;AAAA,yC;;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;;AAEA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,SAAS;;AAET;;AAEA,SAAS;;AAET;AACA,kFAAkF;;AAElF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;;AAET;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAAA;;;;;;;;;;;;;;;;;gEC5KD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;;AAEA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,mHAAmH;AACnH;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,iBAAiB;;AAEzC,aAAa;AACb;;AAEA;AACA,wBAAwB,yBAAyB;AACjD;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6DAA6D,iBAAiB;AAC9E;AACA,KAAK;AACL,CAAC;AAAA","file":"js/spider.bundle.js","sourcesContent":["// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./appSrc/less/spider.less\n// module id = 10\n// module chunks = 2","var _ = require('lodash');\nvar $ = require('../lib/jQuery-3.1.1.min.js');\nvar _locals = {\n    'zh_cn': {\n        B_Title: '标题'\n\n    },\n    'en': {\n        B_Title: 'title'\n    }\n};\n\n\ndefine('modals', function() {\n\n    function Modals(options) {\n        this.options = {\n            opacity: 0.4,\n            strict: true,\n            close: '.model-close',\n            wraper: 'body',\n            status: 'empty'\n        };\n\n        return this.init(_.assign({}, this.options, options));\n    }\n    /*\n        title --  string\n        class  ---   jira\n        opacity ---   0.4\n        head --- 头部\n        body  -- HTML 主要内容区域\n        foot --- \n        style ---- {color:red}\n        yes ---- 确定按钮  默认功能：隐藏弹框\n        no  ---- 取消按钮  默认功能：隐藏弹框\n        strict  ------ 严格 1 宽松 0 默认：1\n    \n        <div class=\"model-box box jira\">\n            <a href=\"javascript:;\" class=\"model-close\"></a>\n            <div class=\"box-head\">\n                <h3 class=\"title\">登录JIRA</h3>\n            </div>  \n            <div class=\"box-body\">\n                <p class=\"input-wraper\">\n                    <input type=\"text\"  name=\"jiraLoginName\" id=\"jira_name\" class=\"form-control\" placeholder=\"JIRA账号\">\n                </p>\n                <p class=\"input-wraper\">\n                    <input type=\"text\" name=\"jiraPassword\" id=\"jira_pwd\" class=\"form-control\" placeholder=\"JIRA密码\">\n                </p>\n                <p class=\"input-wraper\">\n                    <img src=\"http://tlc.xin.com/captcha?ts=\" alt=\"\" class=\"jira-imgCode\">\n                </p>\n                <p class=\"input-wraper\">\n                    <input type=\"button\" class=\"btn\" value=\"登录\" id=\"loginJira\">\n                </p>\n            </div>\n            <div class=\"box-foot\"></div>    \n        </div>\n    */\n\n    Modals.prototype = {\n        constructor: Modals,\n\n        init: function(options) {\n            this.options = options;\n            var that = this;\n            var head = options.head || {};\n            var body = options.body || {};\n\n            var _data = {\n                css: '',\n                body: {\n                    html: '',\n                    class: ''\n                },\n                head: {\n                    html: '',\n                    class: ''\n                },\n                foot: {\n                    html: '',\n                    class: ''\n                }\n            };\n\n            _data.title = options.title || head.title || '';\n            _data.css = options.css || '';\n            if (options.head) {\n                _data.head = _.assign(_data.head, options.head);\n            }\n\n            if (options.body) {\n                _data.body = _.assign(_data.body, options.body);\n            }\n            if (options.foot) {\n                _data.foot = _.assign(_data.foot, options.foot);\n            }\n\n            this.dom = $(this.render(options, _data));\n            this.wrapDom = $(this.options.wraper);\n            this.dom.on('click', this.options.close, function() {\n                that.hide();\n            });\n            if (options.btns) {\n                for (var btn in options.btns) {\n                    (function(btn) {\n                        that.dom.on('click', btn, function(ev) {\n                            options.btns[btn].apply(this, ev);\n                        });\n                    })(btn)\n                }\n            }\n            return this;\n        },\n\n        show: function() {\n            if (this.options.status == 'empty') {\n                this.wrapDom.append(this.dom);\n                if(typeof this.options.aftershow == 'function'){\n                    this.options.aftershow.call(this);\n                }\n            }\n            this.wrapDom.show();\n            this.options.status = 'show';\n        },\n\n        hide: function() {\n            this.wrapDom.hide();\n            this.status = 'hide';\n        },\n\n        afterShow: function() {\n\n        },\n\n        render: function(options, data) {\n            var _html = '<div class=\"model-box box <%=css%>\"><a href=\"javascript:;\" class=\"model-close\"></a>';\n\n            if (data.title) {\n                _html += '<div class=\"box-head <%=head.class%>\"><h3 class=\"title\"><%=title%></h3></div>';\n            }\n            _html += '<div class=\"box-body\">' + (options.strict === false ? '<%= body.html %>' : '<%- body.html %>') + '</div>';\n\n            if (options.foot && options.foot.html) {\n                _html += '<div class=\"box-foot<%=foot.class%>\"><%- foot.html %></div>';\n            }\n            _html += '</div>';\n            var comp = _.template(_html);\n\n            this._tmpl = _html;\n            return comp(data).trim();\n        },\n\n        animate: function() {\n\n        },\n        destory: function() {\n            var that = this,\n                options = that.options;\n            this.dom.off('click', this.options.close);\n            if (options.btns) {\n                for (var btn in options.btns) {\n                    (function(btn) {\n                        that.dom.off('click', btn);\n                    })(btn);\n                }\n            }\n            this.dom.remove();\n        }\n    };\n    return Modals;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./appSrc/lib/dm-modals.js\n// module id = 12\n// module chunks = 2","define('spider', ['../lib/jQuery-3.1.1.min.js', '../lib/dm-modals.js'], function($, modals) {\n    $(function() {\n        var $getBtn = $('#getJira');\n        var $jiraNo = $('#jiraNo');\n        $getBtn.on('click', function(ev) {\n            var jNo = $jiraNo.val();\n            if (!jNo) return;\n            getDataJira(jNo);\n        });\n\n        $('.spider-box').on('click', function(ev) {\n            var $target = $(ev.target);\n            var sClassName = ev.target.className;\n            if (sClassName.indexOf('j-toOut') != -1) {\n                // loginJira(ev);\n            } else if (sClassName.indexOf('j-toLogin') != -1) {\n                // quitJira(ev);\n            }\n        });\n        var loginModal = new modals({\n            title: '登录JIRA',\n            wraper: '.j-loginJira',\n            css: 'jira',\n            body: {\n                html: '<p class=\"input-wraper\"><input type=\"text\"  name=\"jiraLoginName\" id=\"jira_name\" class=\"form-control txt-input\" placeholder=\"JIRA账号\"></p><p class=\"input-wraper\"><input type=\"text\" name=\"jiraPassword\" id=\"jira_pwd\" class=\"form-control txt-input\" placeholder=\"JIRA密码\"></p><p class=\"input-wraper\"><input type=\"button\" class=\"btn\" value=\"登录\" id=\"loginJiraBtn\"></p>'\n            },\n            btns: {\n                '#loginJiraBtn': function(argument) {\n                    loginJira();\n                }\n            },\n            aftershow: function() {\n                $('#jira_name,#jira_pwd').focus(function() {\n                    $(this).removeClass('error');\n                    $('#loginJiraBtn').next().remove();\n                });\n                $('#jira_name').val('dongmin');\n                $('#jira_pwd').val('dong_2017xIn');\n            },\n            strict: false\n        });\n        var captcha = '<p class=\"input-wraper captcha\"><img src=\"http://tlc.xin.com/captcha?ts=' + Date.now() + '\" alt=\"\" class=\"jira-imgCode\"></p>';\n\n        $('.j-toLogin').click(function() {\n            loginModal.show();\n        });\n\n        var status = 'end';\n\n        function loginJira() {\n            if (status == 'run') return;\n            var $name = $('#jira_name');\n            var $pwd = $('#jira_pwd');\n            var result = validate($name, $pwd);\n            if (result.status) {\n                status = 'run';\n                $('#loginJiraBtn').val('登录中...');\n                jiraAction({\n                    'type': 'login',\n                    'jiraName': $name.val(),\n                    'jiraPwd': $pwd.val(),\n                    'captcha': ''\n                }, function(err, data) {\n                    if (err || data.status != 1) {\n                        errorTip(data);\n                        return;\n                    }else if (data.status == '1') {\n                        var time = data.data.time;\n                        var user = data.data.user;\n                        var sHtml = '<span class=\"jira-user\">' + user + '(' + time + ')</span><a href=\"javascript:;\" class=\"j-toOut\">退出jira</a>';\n                        $('.jira-status').html(sHtml);\n                        loginModal.hide();\n                    }\n                });\n                status = 'end';\n                $('#loginJiraBtn').val('登录');\n            }\n        }\n\n        function quitJira() {\n            jiraAction({ 'type': 'quit' }, function(err, data) {\n\n            });\n        }\n\n        function getDataJira(id) {\n            jiraAction({ 'type': 'jira', id: id }, function(err, data) {\n                console.log(data);\n            });\n        }\n\n        function jiraAction(opt, callback) {\n            $.ajax({\n                url: '/admin/spider/jira',\n                type: 'post',\n                data: Object.assign({}, opt),\n                success: function(data, status, xhr) {\n                    callback(null, data);\n                },\n                error: function(xhr, status, err) {\n                    callback(xhr);\n                }\n            });\n        }\n\n        function validate($name, $pwd) {\n            if ($name.val() == '') {\n                var errMsg = {\n                    status: false,\n                    id: '#jira_name',\n                    msg: '账号不能为空'\n                }\n                errorTip(errMsg)\n                return errMsg;\n\n            }\n            if ($pwd.val() == '') {\n                var errMsg = {\n                    status: false,\n                    id: '#jira_pwd',\n                    msg: '密码不能为空'\n                }\n                errorTip(errMsg)\n                return errMsg;\n            }\n            return {\n                status: true,\n                msg: 'success'\n            };\n        }\n\n        function errorTip(info) {\n            $('#loginJiraBtn').next().remove();\n            $(info.id).addClass('error');\n            $('#loginJiraBtn').after('<span style=\"color:red;margin-left:10px;\">' + info.msg + '</span>');\n        }\n    });\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./appSrc/login/spider.js\n// module id = 8\n// module chunks = 2"],"sourceRoot":""}